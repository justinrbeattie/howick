



body [is="bottom-drawer"] {
  --bottom-drawer-nav-height-offset:calc(var(--top-nav-height) + var(--bottom-nav-height));
  --bottom-drawer-top-offset: calc(var(--page-height) - (var(--bottom-drawer-bottom-offset) + var(--bottom-nav-height)));
  --bottom-drawer-top-clip: calc((var(--page-height) - (var(--bottom-nav-height) + var(--bottom-drawer-header-height))) - (var(--bottom-drawer-current-intersection-ratio) * var(--bottom-drawer-top-offset)));
  --bottom-drawer-main-min-height: calc(100% - ( var(--top-nav-height) + var(--bottom-nav-height) + var(--bottom-drawer-bottom-offset)));
    display: unset;
    position: unset;
    left: unset;
    right: unset;
    width: unset;
    height: unset;
    background-color: transparent;
    color:unset;
    margin:unset;
    border:unset;
    border-width: unset;
    border-style: unset;
    border-color: unset;
    border-image: unset;
    border-radius: unset;
    padding: unset;
}

body [is="bottom-drawer"][open] + [is="bottom-drawer"][open] + [is="bottom-drawer"],
body [is="bottom-drawer"][open] + [is="bottom-drawer"][open] + [is="bottom-drawer"] ~ * {
  --bottom-drawer-bottom-offset:calc(var(--bottom-drawer-header-height) * 2);
}

body [is="bottom-drawer"][open] + [is="bottom-drawer"],
body [is="bottom-drawer"][open] + [is="bottom-drawer"] ~ * {
  --bottom-drawer-bottom-offset:calc(var(--bottom-drawer-header-height) * 1);
}

body [is="bottom-drawer"],
body [is="bottom-drawer"] ~ * {
  --bottom-drawer-bottom-offset: 0px;
}

/* Bottom Drawer */

body div,
body nav:first-of-type {
  filter: var(--bottom-drawer-filter);
  transform: var(--bottom-drawer-transform);
}

nav:first-of-type {
  border-top-left-radius: calc(1rem * var(--bottom-drawer-intersection-ratio));
  border-top-right-radius: calc(1rem * var(--bottom-drawer-intersection-ratio));
}

body [is="bottom-drawer"] {
  width:100%;
  grid-row: 1 / -1;
  grid-column: 1;
  align-self: start;
  display: flex;
  flex-direction: column;
  align-items: center;
  scroll-snap-type: y mandatory;
    scroll-snap-stop: always;
  overflow: auto;
  position: absolute;
  height: calc(var(--page-height) - var(--bottom-nav-height));
  clip: rect(calc(-10px + var(--bottom-drawer-top-clip)), 100vw, auto, -100vw);
  transform: translateY(calc(var(--bottom-drawer-bottom-offset) * -1)) translateZ(var(--bottom-drawer-translate-z));
  filter:  brightness(var(--bottom-drawer-lightness,100%));
  transition: --bottom-drawer-bottom-offset 0.5s ease-in-out;
}

body [is="bottom-drawer"][layer="3"] {
  z-index: 3;
}

body [is="bottom-drawer"][layer="2"] {
  z-index: 2;
  --bottom-drawer-total-intersection-ratio:var(--bottom-drawer-3-intersection-ratio);
  --bottom-drawer-translate-z: calc(var(--bottom-drawer-total-intersection-ratio) * -150px );
  --bottom-drawer-lightness: calc(100% - (var(--bottom-drawer-total-intersection-ratio) * 20%));
}


body [is="bottom-drawer"][layer="1"] {
  z-index: 1;
  --bottom-drawer-total-intersection-ratio:calc(var(--bottom-drawer-3-intersection-ratio) + var(--bottom-drawer-2-intersection-ratio) / 2);
  --bottom-drawer-translate-z: calc(var(--bottom-drawer-total-intersection-ratio) * -150px );
  --bottom-drawer-lightness: calc(100% - (var(--bottom-drawer-total-intersection-ratio)  * 30%));
}

body [is="bottom-drawer"] ~ div {
  --body-total-intersection-ratio:calc(var(--bottom-drawer-3-intersection-ratio) + var(--bottom-drawer-2-intersection-ratio)  + var(--bottom-drawer-1-intersection-ratio) / 3);
  --body-translate-y: calc(var(--body-total-intersection-ratio) * 196px);
  --body-translate-z: calc(var(--body-total-intersection-ratio) * -150px );
  --body-lightness: calc(100% - (var(--body-total-intersection-ratio)  * 40%));
  transform: translateY(clamp(0px,var(--body-translate-y), var(--top-nav-height))) translateZ(var(--body-translate-z));
  filter: brightness(var(--body-lightness));
}


body [is="bottom-drawer"]:not([open]) > [placeholder] {
  min-height:100vh;
}

body [is="bottom-drawer"][disabled] {
 opacity:.8;
 pointer-events: none;
}

/* Drawer Placeholder */

body [is="bottom-drawer"] > [placeholder] {
  min-height: calc(100vh - (var(--bottom-nav-height) + var(--bottom-drawer-header-height)));
  pointer-events: none;
  scroll-snap-align: start;
  transition: min-height 0.5s ease-in-out;
}

body [is="bottom-drawer"][expanded] > [placeholder] {
  pointer-events: all;
}

/* Drawer Content */

body [is="bottom-drawer"] > [content] {
  display: flex;
  flex-direction: column;
  gap: 1px;
  width: var(--page-width);
  min-height:var(--bottom-drawer-main-min-height);
  scroll-snap-align: start;
  contain:strict;
  max-width:calc(var(--page-width) - 64px);
  border-top-left-radius: var(--radius-2);
  border-top-right-radius: var(--radius-2);
  border: 2px solid var(--surface-4);
  box-shadow: 0px 0px 16px 0px rgba(0,0,0,0.009);

}

body [is="bottom-drawer"] > [content] > header {
  width: var(--page-width);
  min-height: var(--bottom-drawer-header-height);
  background:var(--surface-1);

}

body [is="bottom-drawer"] > [content] > main {
  display:flex!important;
  width: var(--page-width);
  background:var(--surface-1);
  flex-grow: 1;
  content-visibility: hidden;
}

body [is="bottom-drawer"][expanded] > [content] > main {
  content-visibility: auto;
}

